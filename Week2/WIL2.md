# 모던 자바스크립트 입문 2주차

## 8. 함수

### 함수 정의 방법

1. 함수 선언문

   ```javascript
   function add(a, b) {
     return a + b;
   }
   ```

   - 함수 선언문은 함수 이름을 생략할 수 없다.
2. 함수 리터럴

   ```javascript
   var add = function(a, b) {
     return a + b;
   };
   ```

   - 함수 리터럴은 함수 이름을 생략할 수 있다.
   - 함수 리터럴은 함수 이름을 생략할 수 있기 때문에 익명 함수로도 불린다.
   - 함수 리터럴은 함수 이름을 생략할 수 있기 때문에 함수 표현식이라고도 불린다.
   - 함수 리터럴은 함수 이름을 생략할 수 있기 때문에 함수 선언문이 아닌 문법적인 표현이다.
3. `Function` 생성자로 정의

   ```javascript
   var add = new Function('a', 'b', 'return a + b');
   ```

   - `Function` 생성자로 정의하는 방법은 사용하지 않는 것이 좋다.
   - `Function` 생성자로 정의하는 방법은 함수 리터럴로 정의하는 것보다 느리다.
   - `Function` 생성자로 정의하는 방법은 함수 리터럴로 정의하는 것보다 가독성이 떨어진다.
4. 화살표 함수

   ```javascript
   var add = (a, b) => a + b;
   ```

   - 화살표 함수는 함수 리터럴을 축약한 것이다.
   - 화살표 함수는 익명 함수로만 정의할 수 있다.
   - 화살표 함수는 함수 리터럴보다 가독성이 좋다.


### 중첩 함수

- 함수 안에 함수를 정의할 수 있다.
- 중첩 함수는 외부 함수의 지역변수에 저장되므로...
    - 자신을 감싼 외부 함수 안에서만 호출할 수 있다.
    - 자신을 감싼 외부 함수의 인수와 지역변수에 접근할 수 있다.
- 외부 함수의 변수 스코프가 중첩 함수에도 적용된다는 것은 클로저의 핵심 원리이다.


### 즉시 실행 함수

- 즉시 실행 함수는 함수를 정의하고 즉시 호출하는 것이다.
- 익명 함수는 다음과 같이 정의하고 할당했다.
```javascript
var add = function(a, b) {
  return a + b;
};

console.log(add(2, 3)); // 5
```
- 이를 즉시 호출하는 것은 다음과 같다.

```javascript
(function(a, b) {
  return a + b;
})(2, 3); // 5
```
- 구체적인 원리는 다음과 같다.
    - 익명 함수를 괄호로 감싸면 함수 정의식이 평가되어 함수 객체(의 참조값)이 된다.
- 즉시 실행 함수는 IIFE(Immediately Invoked Function Expression)라고도 불린다.
- 즉시 실행 함수는 비공개 변수를 만들 때 사용한다. 즉 전역 스코프를 오염시키지 않는 네임스페이스를 만들 때 사용한다.

### 실행 컨텍스트

JS는 실행 가능 코드를 만나면 코드를 평가 후 이를 실행 컨텍스트로 만든다.
실행 가능 코드의 유형은 다음과 같다.

- 전역 코드 : `Window` 객체에 정의된 코드
- 함수 코드 : 함수 내에 정의된 코드
- eval 코드 : `eval` 함수로 실행되는 코드

각 유형이 다른 이유는 실행 가능 코드로 만들어지는 실행 컨텍스트가 다르기 때문이다. `eval`은 일반적인 렉시컬 환경이 아닌 동적인 렉시컬 환경을 갖는다.

실행 컨텍스트는 여러 컴포넌트로 구성된다.

- 렉시컬 환경 컴포넌트
    - 환경 레코드 : 스코프에 포함된 식별자 정보를 바탕으로 식별자를 검색하고 바인딩하는 환경에 대한 정보를 담고 있다.
    - 외부 렉시컬 환경 참조 : 외부 함수의 렉시컬 환경에 대한 참조를 저장한다.
- 변수 환경 컴포넌트
- 디스 바인딩 컴포넌트

#### 환경 레코드

- 선언적 환경 레코드
    - 함수 선언문, 변수 선언문, `try-catch` 문의 `catch` 절 등에서 사용하는 식별자 정보를 바탕으로 식별자를 검색하고 바인딩하는 환경에 대한 정보를 담고 있다.
- 객체 환경 레코드
    - 전역 객체와 `with` 문에서 사용하는 식별자 정보를 바탕으로 식별자를 검색하고 바인딩하는 환경에 대한 정보를 담고 있다.